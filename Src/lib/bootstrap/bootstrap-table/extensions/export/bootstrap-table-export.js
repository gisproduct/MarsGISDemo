/* 2018-8-23 19:31:45 | 版权所有 火星科技 http://marsgis.cn  【联系我们QQ：516584683，微信：marsgis】 */
!function(r){"use strict";var s=r.fn.bootstrapTable.utils.sprintf,a={json:"JSON",xml:"XML",png:"PNG",csv:"CSV",txt:"TXT",sql:"SQL",doc:"Word文档",excel:"Excel文档",xlsx:"MS-Excel (OpenXML)",powerpoint:"MS-Powerpoint",pdf:"PDF"};r.extend(r.fn.bootstrapTable.defaults,{showExport:!1,exportDataType:"basic",exportTypes:["json","xml","csv","txt","sql","excel"],exportOptions:{}}),r.extend(r.fn.bootstrapTable.defaults.icons,{export:" fa-download  icon-share"}),r.extend(r.fn.bootstrapTable.locales,{formatExport:function(){return"导出数据"}}),r.extend(r.fn.bootstrapTable.defaults,r.fn.bootstrapTable.locales);var t=r.fn.bootstrapTable.Constructor,l=t.prototype.initToolbar;t.prototype.initToolbar=function(){if(this.showToolbar=this.showToolbar||this.options.showExport,l.apply(this,Array.prototype.slice.apply(arguments)),this.options.showExport){var p=this,t=this.$toolbar.find(">.btn-group"),o=t.find("div.export");if(!o.length){var e=(o=r(['<div class="export btn-group">','<button class="btn'+s(" btn-%s",this.options.buttonsClass)+s(" btn-%s",this.options.iconSize)+' dropdown-toggle" aria-label="export type" title="'+this.options.formatExport()+'" data-toggle="dropdown" type="button">',s('<i class="%s %s"></i> 导出',this.options.iconsPrefix,this.options.icons.export),'<span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">',"</ul>","</div>"].join("")).appendTo(t)).find(".dropdown-menu"),n=this.options.exportTypes;if("string"==typeof this.options.exportTypes){var i=this.options.exportTypes.slice(1,-1).replace(/ /g,"").split(",");n=[],r.each(i,function(t,o){n.push(o.slice(1,-1))})}r.each(n,function(t,o){a.hasOwnProperty(o)&&e.append(['<li role="menuitem" data-type="'+o+'">','<a href="javascript:void(0)">',a[o],"</a>","</li>"].join(""))}),e.find("li").click(function(){var s=r(this).data("type"),t=function(){if(p.options.exportFooter){var t=p.getData(),o=p.$tableFooter.find("tr").first(),n={},i=[];r.each(o.children(),function(t,o){var e=r(o).children(".th-inner").first().html();n[p.columns[t].field]="&nbsp;"==e?null:e,i.push(e)}),p.append(n);var e=p.$body.children().last();r.each(e.children(),function(t,o){r(o).html(i[t])})}p.$el.tableExport(r.extend({},p.options.exportOptions,{type:s,escape:!1})),p.options.exportFooter&&p.load(t)},o=p.header.stateField;if("all"===p.options.exportDataType&&p.options.pagination)p.$el.one("server"===p.options.sidePagination?"post-body.bs.table":"page-change.bs.table",function(){o&&p.hideColumn(o),t(),p.togglePagination()}),p.togglePagination();else if("selected"===p.options.exportDataType){var e=p.getData(),n=p.getSelections();if(!n.length)return;if("server"===p.options.sidePagination){var i={total:p.options.totalRows};i[p.options.dataField]=e,e=i;var a={total:n.length};a[p.options.dataField]=n,n=a}p.load(n),o&&p.hideColumn(o),t(),p.load(e)}else o&&p.hideColumn(o),t();o&&p.showColumn(o)})}}}}(jQuery);