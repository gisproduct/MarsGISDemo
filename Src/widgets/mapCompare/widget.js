/* 2018-6-27 18:42:25 | 版权所有 火星科技 http://marsgis.cn  【联系我们QQ：516584683，微信：marsgis】 */
L.widget.bindClass(L.widget.BaseWidget.extend({map:null,options:{resources:["view.css"],view:{type:"append",url:"view.html",parent:"body"}},winCreateOK:function(t,e){var i=this;$("#btn_mapCompare_sp").click(function(){$("#centerDiv").css({height:"100%",width:"50%"}),$("#centerDivEx").css({top:"0px",bottom:"0px",right:"0px",height:"100%",width:"50%"}),i.invalidateSize(),i.mapEx.invalidateSize(!1)}),$("#btn_mapCompare_cz").click(function(){$("#centerDiv").css({height:"50%",width:"100%"}),$("#centerDivEx").css({top:"50%",bottom:"0px",right:"0px",height:"50%",width:"100%"}),i.invalidateSize(),i.mapEx.invalidateSize(!1)}),$("#btn_mapCompare_close").click(function(){i.disableBase()})},mapEx:null,activate:function(){$(".toolBar").css({right:"250px"});$("body").append('<div id="centerDivEx" style="position:absolute;right:0px;top:0px;border:1px solid #ccc;top: 0px;bottom: 0px;width:50%;overflow: hidden;"><div id="mapEx" style="height:100%;width:100%;overflow: hidden;"></div></div>'),$("#centerDiv").css({position:"absolute",height:"100%",width:"50%"}),this.invalidateSize();var t=haoutil.system.clone(this.map.gisdata.config);for(var e in this.mapEx=L.mars.createMap({id:"mapEx",layerToMap:layerToMap,data:t}),this.mapEx.gisdata.baselayers){var i=this.mapEx.gisdata.baselayers[e];if(!i.config.visible&&(null==i.config.crs||i.config.crs==t.crs)){this.mapEx.addLayer(i);break}}this.mapEx.gisdata.controls.layer||L.control.layers(this.mapEx.gisdata.baselayers,this.mapEx.gisdata.overlayers,{position:"topleft"}).addTo(this.mapEx),this.map.on("movestart",this._map_movestartHandler,this),this.mapEx.on("movestart",this._mapEx_movestartHandler,this),this.mapEx.setView(this.map.getCenter(),this.map.getZoom(),{animate:!1,noMoveStart:!0})},disable:function(){$(".toolBar").css({right:"10px"}),this.map.off("movestart",this._map_movestartHandler,this),this.map.off("moveend",this._map_moveendHandler,this),this.mapEx.off("movestart",this._mapEx_movestartHandler,this),this.mapEx.off("moveend",this._mapEx_moveendHandler,this),this.mapEx.remove(),this.mapEx=null,$("#centerDivEx").remove(),$("#btnMapComType").remove(),$("#centerDiv").css({position:"",height:"100%",width:"100%"}),this.invalidateSize()},invalidateSize:function(){var t=this.map,e=this.mapEx;setTimeout(function(){t.invalidateSize(!1),e&&e.invalidateSize(!1)},100)},_map_movestartHandler:function(t){this.map.on("moveend",this._map_moveendHandler,this)},_map_moveendHandler:function(t){this.map.off("moveend",this._map_moveendHandler,this),this.mapEx.setView(this.map.getCenter(),this.map.getZoom(),{animate:!1,noMoveStart:!0})},_mapEx_movestartHandler:function(t){this.mapEx.on("moveend",this._mapEx_moveendHandler,this)},_mapEx_moveendHandler:function(t){this.mapEx.off("moveend",this._mapEx_moveendHandler,this),this.map.setView(this.mapEx.getCenter(),this.mapEx.getZoom(),{animate:!1,noMoveStart:!0})}}));