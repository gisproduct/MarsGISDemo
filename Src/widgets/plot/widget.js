/* 2018-8-24 18:35:23 | 版权所有 火星科技 http://marsgis.cn  【联系我们QQ：516584683，微信：marsgis】 */
L.widget.bindClass(L.widget.BaseWidget.extend({map:null,options:{view:{type:"window",url:"view.html",windowOptions:{width:250}}},workDraw:null,layerDraw:null,create:function(){var r=this;this.workDraw=new L.mars.Draw({map:this.map,isOnly:!1,hasDel:!0,style:{color:"#ff0000",weight:2},onEvnet:!1,onCreate:function(t){r.viewWindow.plotlist.plotEnd()},onChange:function(t){var i=r.workDraw.currEditFeature,n=L.mars.layer.getLatlngs(i);i.constructor===L.Circle?r.startEditing(i):r.viewWindow.plotEdit.updateLatlngsHtml(n)},onStartEditing:function(t){r.startEditing(t)},onStopEditing:function(t){r.stopEditing(t)}}),this.layerDraw=this.workDraw.getLayer(),bindToLayerControl("标绘",this.layerDraw)},viewWindow:null,winCreateOK:function(t,i){this.viewWindow=i},activate:function(){this.workDraw.onEvnet(),this.map.addLayer(this.layerDraw)},disable:function(){this.viewWindow=null,this.workDraw.destroy(!0)},startDraw:function(t){this.workDraw.startDraw(t.type,t)},_last_layer:null,startEditing:function(t){this._last_layer=t;var i=L.mars.layer.getLatlngs(t);this.viewWindow&&this.viewWindow.plotEdit.startEditing(t.properties,i)},stopEditing:function(t){this.viewWindow&&this.viewWindow.plotEdit.stopEditing()},updateAttr2map:function(t){this.workDraw.updateProperties(this._last_layer,t)},getGeoJson:function(){return this.workDraw.toJson()},jsonToLayer:function(t,i){return this.workDraw.jsonToLayer(t,i,!0)},deleteAll:function(){this.workDraw.clearDraw()},hasEdit:function(t){this.workDraw.hasEdit(t)}}));