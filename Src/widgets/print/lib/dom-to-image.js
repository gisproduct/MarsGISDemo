/* 2018-9-28 20:15:16 | 版权所有 火星科技 http://marsgis.cn  【联系我们QQ：516584683，微信：marsgis】 */
!function(e){"use strict";var c=function(){return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:o,mimeType:function(e){var t=o(e).toLowerCase();return(n="application/font-woff",r="image/jpeg",{woff:n,woff2:n,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:r,jpeg:r,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[t]||"";var n,r},dataAsUrl:function(e,t){return"data:"+t+";base64,"+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(t){return t.toBlob?new Promise(function(e){t.toBlob(e)}):(i=t,new Promise(function(e){for(var t=window.atob(i.toDataURL().split(",")[1]),n=t.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=t.charCodeAt(o);e(new Blob([r],{type:"image/png"}))}));var i},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var o=n.createElement("a");return n.body.appendChild(o),r.href=t,o.href=e,o.href},getAndEncode:function(i){u.impl.options.cacheBust&&(i+=(/\?/.test(i)?"&":"?")+(new Date).getTime());i.startsWith("http")&&-1==i.indexOf(location.hostname)&&(u.proxy?i=u.proxy(i):u.preUrl&&(i=u.preUrl+i));return new Promise(function(n){var e,r=new XMLHttpRequest;if(r.onreadystatechange=function(){if(4!==r.readyState)return;if(200!==r.status)e?n(e):o("无法获取资源: "+i+", 状态: "+r.status);else{var t=new FileReader;t.onloadend=function(){var e=t.result.split(/,/)[1];n(e)},t.readAsDataURL(r.response)}},r.ontimeout=function(){e?n(e):o("抓取资源时发生超时（100000ms）: "+i)},r.responseType="blob",r.timeout=1e5,r.open("GET",i,!0),r.send(),u.impl.options.imagePlaceholder){var t=u.impl.options.imagePlaceholder.split(/,/);t&&t[1]&&(e=t[1])}function o(e){console.log(e),n("iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMwAov9iAAKCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==")}})},uid:(e=0,function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+e++}),delay:function(n){return function(t){return new Promise(function(e){setTimeout(function(){e(t)},n)})}},asArray:function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t},escapeXhtml:function(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(r){return new Promise(function(e,t){var n=new Image;n.crossOrigin="*",n.onload=function(){e(n)},n.onerror=t,n.src=r})},width:function(e){var t=r(e,"border-left-width"),n=r(e,"border-right-width");return e.scrollWidth+t+n},height:function(e){var t=r(e,"border-top-width"),n=r(e,"border-bottom-width");return e.scrollHeight+t+n}};var e;function o(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function r(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}}(),o=function(){var r=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(t,r,o){return e(t)?Promise.resolve(t).then(n).then(function(e){var n=Promise.resolve(t);return e.forEach(function(t){n=n.then(function(e){return i(e,t,r,o)})}),n}):Promise.resolve(t)},shouldProcess:e,impl:{readUrls:n,inline:i}};function e(e){return-1!==e.search(r)}function n(e){for(var t,n=[];null!==(t=r.exec(e));)n.push(t[1]);return n.filter(function(e){return!c.isDataUrl(e)})}function i(n,r,t,e){return Promise.resolve(r).then(function(e){return t?c.resolveUrl(e,t):e}).then(e||c.getAndEncode).then(function(e){return c.dataAsUrl(e,c.mimeType(r))}).then(function(e){return n.replace((t=r,new RegExp("(url\\(['\"]?)("+c.escape(t)+")(['\"]?\\))","g")),"$1"+e+"$3");var t})}}(),t=function(){return{resolveAll:function(){return e(document).then(function(e){return Promise.all(e.map(function(e){return e.resolve()}))}).then(function(e){return e.join("\n")})},impl:{readAll:e}};function e(){return Promise.resolve(c.asArray(document.styleSheets)).then(function(e){var n=[];return e.forEach(function(t){try{c.asArray(t.cssRules||[]).forEach(n.push.bind(n))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}}),n}).then(function(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return o.shouldProcess(e.style.getPropertyValue("src"))})}).then(function(e){return e.map(t)});function t(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return o.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}}}(),n=function(){return{inlineAll:function t(e){if(!(e instanceof Element))return Promise.resolve(e);return n(e).then(function(){return e instanceof HTMLImageElement?r(e).inline():Promise.all(c.asArray(e.childNodes).map(function(e){return t(e)}))});function n(t){var e=t.style.getPropertyValue("background");return e?o.inlineAll(e).then(function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))}).then(function(){return t}):Promise.resolve(t)}},impl:{newImage:r}};function r(r){return{inline:function(e){return c.isDataUrl(r.src)?Promise.resolve():Promise.resolve(r.src).then(e||c.getAndEncode).then(function(e){return c.dataAsUrl(e,c.mimeType(r.src))}).then(function(n){return new Promise(function(e,t){r.onload=e,r.onerror=t,r.src=n})})}}}}(),r={imagePlaceholder:void 0,cacheBust:!1},u={toSvg:i,toPng:function(e,t){return a(e,t||{}).then(function(e){return e.toDataURL()})},toJpeg:function(e,t){return a(e,t=t||{}).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})},toBlob:function(e,t){return a(e,t||{}).then(c.canvasToBlob)},toPixelData:function(t,e){return a(t,e||{}).then(function(e){return e.getContext("2d").getImageData(0,0,c.width(t),c.height(t)).data})},impl:{fontFaces:t,images:n,util:c,inliner:o,options:{}}};function i(o,i){return function(e){void 0===e.imagePlaceholder?u.impl.options.imagePlaceholder=r.imagePlaceholder:u.impl.options.imagePlaceholder=e.imagePlaceholder;void 0===e.cacheBust?u.impl.options.cacheBust=r.cacheBust:u.impl.options.cacheBust=e.cacheBust}(i=i||{}),Promise.resolve(o).then(function(e){return function i(t,n,e){if(!e&&n&&!n(t))return Promise.resolve();return Promise.resolve(t).then(r).then(function(e){return o(t,e,n)}).then(function(e){return u(t,e)});function r(e){return e instanceof HTMLCanvasElement?c.makeImage(e.toDataURL()):e.cloneNode(!1)}function o(e,t,n){var r=e.childNodes;return 0===r.length?Promise.resolve(t):o(t,c.asArray(r),n).then(function(){return t});function o(t,e,n){var r=Promise.resolve();return e.forEach(function(e){r=r.then(function(){return i(e,n)}).then(function(e){e&&t.appendChild(e)})}),r}}function u(u,a){return a instanceof Element?Promise.resolve().then(e).then(t).then(n).then(r).then(function(){return a}):a;function e(){function e(e,t){var n,r;e.cssText?t.cssText=e.cssText:(n=e,r=t,c.asArray(n).forEach(function(e){r.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))}))}e(window.getComputedStyle(u),a.style)}function t(){function t(e){var t=window.getComputedStyle(u,e),n=t.getPropertyValue("content");if(""!==n&&"none"!==n){var r=c.uid();a.className=a.className+" "+r;var o=document.createElement("style");o.appendChild(i(r,e,t)),a.appendChild(o)}function i(e,t,n){var r,o,i="."+e+":"+t,u=n.cssText?(o=(r=n).getPropertyValue("content"),r.cssText+" content: "+o+";"):a(n);return document.createTextNode(i+"{"+u+"}");function a(t){return c.asArray(t).map(e).join("; ")+";";function e(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}}}}[":before",":after"].forEach(function(e){t(e)})}function n(){u instanceof HTMLTextAreaElement&&(a.innerHTML=u.value),u instanceof HTMLInputElement&&a.setAttribute("value",u.value)}function r(){a instanceof SVGElement&&(a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a instanceof SVGRectElement&&["width","height"].forEach(function(e){var t=a.getAttribute(e);t&&a.style.setProperty(e,t)}))}}}(e,i.filter,!0)}).then(l).then(s).then(function(t){i.bgcolor&&(t.style.backgroundColor=i.bgcolor);i.width&&(t.style.width=i.width+"px");i.height&&(t.style.height=i.height+"px");i.style&&Object.keys(i.style).forEach(function(e){t.style[e]=i.style[e]});return t}).then(function(e){return t=e,n=i.width||c.width(o),r=i.height||c.height(o),Promise.resolve(t).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)}).then(c.escapeXhtml).then(function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"}).then(function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+n+'" height="'+r+'">'+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e});var t,n,r})}function a(n,r){return i(n,r).then(c.makeImage).then(c.delay(100)).then(function(e){var t=function(e){var t=document.createElement("canvas");if(t.width=r.width||c.width(e),t.height=r.height||c.height(e),r.bgcolor){var n=t.getContext("2d");n.fillStyle=r.bgcolor,n.fillRect(0,0,t.width,t.height)}return t}(n);return t.getContext("2d").drawImage(e,0,0),t})}function l(n){return t.resolveAll().then(function(e){var t=document.createElement("style");return n.appendChild(t),t.appendChild(document.createTextNode(e)),n})}function s(e){return n.inlineAll(e).then(function(){return e})}e.domtoimage=u}(window);